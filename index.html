<!DOCTYPE html>
<html lang="rw">
<head>
  <!--
    index.html ‚Äî Landing Page yihariye ya Boutique
    Byubatswe mu HTML, CSS, na JavaScript gusa
    - Video background + fallback image
    - Responsive 100% kuri mobile
    - Dark mode toggle
    - Smooth scrolling + animated reveal
    - Audio greeting mu Gifaransa
    - Web Speech API: SpeechRecognition + SpeechSynthesis (ijwi rya chatbot mu Kiswahili)
    - Chatbot ifite Puter.js style logic (placeholders + hooks)
    - JSON stock embedded + live search
    - Daily Joke Spinner (localStorage)
    - Google Maps (Gihosha Gisandema)
    - Contact Form (FormSubmit.io)
    - WhatsApp Support (wa.me)
    - Footer n‚Äôamakuru yose
  -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Boutique Gihosha ‚Äî LP y‚ÄôUbwenge</title>
  <meta name="description" content="Boutique yihariye ifite chatbot y‚ÄôUbwenge, stock ya JSON, jokes, na serivisi nziza." />
  <link rel="preload" as="image" href="fallback.jpg">
  <style>
    /* ------------------------------
       Base styles & variables
    ------------------------------- */
    :root {
      --bg: #0f1115;
      --bg-soft: #141821;
      --text: #e6e6e6;
      --muted: #b8c0cc;
      --primary: #2dd4bf;
      --primary-2: #22c55e;
      --accent: #a78bfa;
      --danger: #ef4444;
      --card: #1a1f2b;
      --border: #243042;
      --shadow: 0 10px 25px rgba(0,0,0,0.35);
    }
    /* Light mode */
    :root.light {
      --bg: #f8fafc;
      --bg-soft: #ffffff;
      --text: #0f172a;
      --muted: #475569;
      --primary: #0ea5e9;
      --primary-2: #16a34a;
      --accent: #7c3aed;
      --danger: #dc2626;
      --card: #f1f5f9;
      --border: #cbd5e1;
      --shadow: 0 8px 20px rgba(0,0,0,0.12);
    }

    * { box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
    }

    a { color: var(--primary); text-decoration: none; }
    img, video { max-width: 100%; display: block; }
    button {
      cursor: pointer;
      border: none;
      border-radius: 10px;
      padding: 12px 18px;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: #fff;
      font-weight: 600;
      box-shadow: var(--shadow);
      transition: transform .2s ease, box-shadow .2s ease, filter .2s ease;
    }
    button:focus { outline: 2px solid var(--accent); outline-offset: 2px; }
    button:hover { transform: translateY(-1px); filter: brightness(1.05); }

    /* ------------------------------
       Layout helpers
    ------------------------------- */
    .container { width: 100%; max-width: 1100px; margin: 0 auto; padding: 0 16px; }
    .section { padding: 80px 0; position: relative; }
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      box-shadow: var(--shadow);
      padding: 20px;
    }
    .grid {
      display: grid;
      gap: 16px;
    }
    @media (min-width: 768px) {
      .grid-2 { grid-template-columns: 1fr 1fr; }
      .grid-3 { grid-template-columns: repeat(3, 1fr); }
    }

    /* ------------------------------
       Header & dark mode toggle
    ------------------------------- */
    header {
      position: fixed; top: 0; left: 0; right: 0;
      z-index: 50; backdrop-filter: blur(8px);
      background: rgba(20, 24, 33, .65);
      border-bottom: 1px solid var(--border);
    }
    :root.light header { background: rgba(255,255,255,.7); }
    .nav {
      display: flex; align-items: center; justify-content: space-between;
      padding: 12px 16px;
    }
    .brand {
      display: flex; align-items: center; gap: 10px;
      font-weight: 800; letter-spacing: .3px;
    }
    .brand .logo {
      width: 36px; height: 36px; border-radius: 10px;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      box-shadow: var(--shadow);
    }
    .nav-links {
      display: none; gap: 16px; font-weight: 600;
    }
    @media (min-width: 880px) {
      .nav-links { display: flex; }
    }
    .mode-toggle {
      background: var(--card); color: var(--text);
      border: 1px solid var(--border); padding: 8px 12px;
      border-radius: 10px; font-weight: 700;
    }

    /* ------------------------------
       Hero with video background
    ------------------------------- */
    .hero {
      position: relative; min-height: 100vh; display: flex; align-items: center; justify-content: center;
      text-align: center; color: #fff; overflow: hidden;
    }
    .hero::after {
      content: ""; position: absolute; inset: 0;
      background: linear-gradient(180deg, rgba(0,0,0,.45), rgba(0,0,0,.65));
    }
    .hero video, .hero .fallback {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      object-fit: cover; z-index: -2;
    }
    .hero-content {
      position: relative; z-index: 2; max-width: 850px; padding: 20px;
      animation: fadeUp .9s ease both;
    }
    .hero-title { font-size: 42px; margin: 0 0 10px; letter-spacing: .2px; }
    .hero-sub { color: #dbeafe; font-size: 18px; margin-bottom: 24px; }
    .hero-cta {
      display: inline-flex; align-items: center; gap: 10px;
    }
    .hero-cta button { font-size: 16px; }

    /* ------------------------------
       Animated reveals
    ------------------------------- */
    .reveal { opacity: 0; transform: translateY(20px); transition: all .7s ease; }
    .reveal.visible { opacity: 1; transform: translateY(0); }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ------------------------------
       Stock table
    ------------------------------- */
    .stock-controls {
      display: flex; gap: 10px; align-items: center; margin-bottom: 12px;
    }
    .search {
      flex: 1; padding: 10px 12px; border-radius: 10px;
      border: 1px solid var(--border); background: var(--bg-soft); color: var(--text);
    }
    table {
      width: 100%; border-collapse: collapse; overflow: hidden; border-radius: 12px;
    }
    thead th {
      text-align: left; background: var(--bg-soft); color: var(--muted);
      padding: 12px; border-bottom: 1px solid var(--border);
    }
    tbody td {
      padding: 12px; border-bottom: 1px solid var(--border);
      vertical-align: middle;
    }
    tbody tr { transition: background .2s ease, transform .2s ease; }
    tbody tr:hover { background: rgba(255,255,255,.03); transform: scale(1.005); }
    .prod-img {
      width: 72px; height: 72px; border-radius: 10px; object-fit: cover; border: 1px solid var(--border);
    }
    .price { font-weight: 800; color: var(--primary-2); }

    /* ------------------------------
       Testimonials
    ------------------------------- */
    .testimonial { display: flex; gap: 12px; align-items: flex-start; }
    .avatar {
      width: 48px; height: 48px; border-radius: 50%; background: var(--bg-soft);
      border: 1px solid var(--border);
    }
    .stars { color: #fbbf24; font-size: 18px; }

    /* ------------------------------
       Daily Joke Spinner
    ------------------------------- */
    .joke-box { display: flex; flex-direction: column; gap: 12px; }
    .joke-text { font-size: 18px; background: var(--bg-soft); border: 1px solid var(--border); border-radius: 12px; padding: 14px; }

    /* ------------------------------
       Chatbot
    ------------------------------- */
    .chatbot {
      display: grid; gap: 16px;
    }
    .chat-window {
      background: var(--bg-soft); border: 1px solid var(--border);
      border-radius: 14px; padding: 10px; height: 320px; overflow-y: auto;
    }
    .msg {
      display: inline-flex; flex-direction: column; gap: 6px;
      max-width: 80%; margin: 8px 0; padding: 10px 12px; border-radius: 12px;
      box-shadow: var(--shadow);
    }
    .msg.user { background: #0b3c49; color: #d9f5ff; align-self: flex-end; }
    .msg.bot { background: #1f2937; color: #e5e7eb; align-self: flex-start; }
    .msg img { border-radius: 10px; border: 1px solid var(--border); }
    .chat-controls { display: flex; gap: 8px; }
    .input {
      flex: 1; padding: 10px 12px; border-radius: 10px;
      border: 1px solid var(--border); background: var(--bg-soft); color: var(--text);
    }
    .voice-btn, .send-btn, .img-btn {
      background: var(--card); color: var(--text);
      border: 1px solid var(--border);
    }

    /* ------------------------------
       Maps
    ------------------------------- */
    .map-embed iframe { width: 100%; height: 360px; border: 0; border-radius: 12px; }

    /* ------------------------------
       Contact & WhatsApp Support
    ------------------------------- */
    .form-grid { display: grid; gap: 10px; }
    @media (min-width: 720px) { .form-grid.grid-2 { grid-template-columns: 1fr 1fr; } }
    .input, textarea {
      width: 100%;
    }
    textarea { min-height: 120px; resize: vertical; }

    /* ------------------------------
       Footer
    ------------------------------- */
    footer {
      padding: 30px 16px; border-top: 1px solid var(--border);
      background: var(--bg-soft); color: var(--muted);
    }
    .footer-grid {
      display: grid; gap: 12px;
    }
    @media (min-width: 768px) {
      .footer-grid { grid-template-columns: 2fr 1fr 1fr; }
    }
    .socials { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
    .qr {
      width: 120px; height: 120px; border-radius: 10px; background: var(--card);
      border: 1px solid var(--border);
    }

    /* ------------------------------
       Accessibility helpers
    ------------------------------- */
    .sr-only {
      position: absolute;
      width: 1px; height: 1px;
      padding: 0; margin: -1px;
      overflow: hidden; clip: rect(0, 0, 0, 0);
      border: 0;
    }
  </style>
</head>
<body>
  <!-- ===========================
       Header & Navigation
       - Dark mode toggle
       - Quick links
  ============================ -->
  <header>
    <nav class="nav container">
      <div class="brand" aria-label="Boutique Gihosha">
        <div class="logo" aria-hidden="true"></div>
        <span>Boutique Gihosha</span>
      </div>
      <div class="nav-links">
        <a href="#hero">Ahabanza</a>
        <a href="#stock">Ibicuruzwa</a>
        <a href="#feedback">Ivyo bavuze</a>
        <a href="#jokes">Joke</a>
        <a href="#chatbot">Chatbot</a>
        <a href="#maps">Aho turi</a>
        <a href="#contact">Tuvugane</a>
      </div>
      <button class="mode-toggle" id="modeToggle" aria-label="Hindura Dark/Light">üåô/‚òÄÔ∏è</button>
    </nav>
  </header>

  <!-- ===========================
       Hero Section
       - Video background + fallback
       - Audio greeting mu Gifaransa
       - CTA "Dushorere kugiciro gito"
  ============================ -->
  <section id="hero" class="hero" aria-label="Hero section y'ahabanza">
    <!-- Video background -->
    <video id="bgVideo" autoplay muted loop playsinline poster="fallback.jpg">
      <!-- Shyiramo video yawe hano (mp4/webm). -->
      <source src="background.mp4" type="video/mp4">
      <source src="background.webm" type="video/webm">
    </video>
    <!-- Fallback image igihe video itaboneka -->
    <img class="fallback" src="fallback.jpg" alt="Boutique background" />

    <div class="hero-content container">
      <h1 class="hero-title">Boutique Gihosha ‚Äî Serivisi y‚ÄôUbwenge üõçÔ∏è</h1>
      <p class="hero-sub">
        Dushora, tugurisha, kandi tugufasha guhitamo ibicuruzwa vyiza ku giciro ciza. Vugana natwe mu ijwi, tubigure neza!
      </p>
      <div class="hero-cta">
        <button id="cta" aria-label="Dushorere kugiciro gito">Dushorere kugiciro gito</button>
        <a href="#stock" class="card" style="padding:8px 12px">Raba ibicuruzwa</a>
      </div>
      <!-- Audio greeting mu Gifaransa (auto-play on interaction) -->
      <audio id="frGreeting" preload="auto">
        <!-- Shyiramo audio yawe (.mp3/.ogg) hano -->
        <source src="greeting_fr.mp3" type="audio/mpeg" />
        <source src="greeting_fr.ogg" type="audio/ogg" />
      </audio>
      <p class="sr-only" id="ctaSubject">Sujet: Dushorere kugiciro gito</p>
    </div>
  </section>

  <main>
    <!-- ===========================
         Stock Section
         - Table + animated entry
         - Live search
         - JSON embedded
    ============================ -->
    <section id="stock" class="section reveal" aria-label="Ibicuruzwa biri muri stock">
      <div class="container">
        <h2>Ibicuruzwa biri mu stock üì¶</h2>
        <p class="muted">Hitamwo ibicuruzwa, urashobora gushakisha uciye kuri search bar hasi.</p>

        <div class="card">
          <div class="stock-controls">
            <label for="search" class="sr-only">Shakisha</label>
            <input id="search" class="search" type="search" placeholder="Shakisha izina/description..." />
            <button id="refreshStock" class="mode-toggle">üîÑ Vugurura</button>
          </div>

          <div class="table-wrap">
            <table aria-label="Table y'ibicuruzwa">
              <thead>
                <tr>
                  <th>Image</th>
                  <th>Description</th>
                  <th>Igiciro</th>
                </tr>
              </thead>
              <tbody id="stockBody">
                <!-- Rows zica zongerwako dynamically -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Embedded JSON stock (murwandiko rumwe) -->
      <script type="application/json" id="stockJSON">
        {
          "items": [
            {
              "id": "SKU-001",
              "name": "T-Shirt Cotton",
              "desc": "T-Shirt y'umwenda mwiza, iroroshye kandi ihumeka.",
              "price": "BIF 18,000",
              "img": "img/tshirt.jpg",
              "tags": ["cotton", "umwenda", "t-shirt", "white"]
            },
            {
              "id": "SKU-002",
              "name": "Sneakers Street",
              "desc": "Inkweto za sport, ziremerewe neza, zishimisha kugenda.",
              "price": "BIF 75,000",
              "img": "img/sneakers.jpg",
              "tags": ["inkweto", "sport", "sneakers", "black"]
            },
            {
              "id": "SKU-003",
              "name": "Cap Classic",
              "desc": "Icap y'umusaga, yerekana style yawe y'umunsi ku wundi.",
              "price": "BIF 12,000",
              "img": "img/cap.jpg",
              "tags": ["cap", "umusaga", "headwear"]
            },
            {
              "id": "SKU-004",
              "name": "Bag Leather",
              "desc": "Isakoshi y'uruhu, iramba kandi igezweho.",
              "price": "BIF 120,000",
              "img": "img/bag.jpg",
              "tags": ["bag", "uruhu", "leather", "brown"]
            }
          ]
        }
      </script>
    </section>

    <!-- ===========================
         Feedback Section
         - Testimonials + emojis + stars
    ============================ -->
    <section id="feedback" class="section reveal" aria-label="Ivyo abakiriya bavuze">
      <div class="container">
        <h2>Ivyo abakiriya bacu bavuze üí¨</h2>
        <div class="grid grid-3">
          <div class="card testimonial">
            <div class="avatar" aria-hidden="true"></div>
            <div>
              <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
              <p><strong>Clarisse:</strong> Serivisi yihuta cane! üòä Inkweto zanje zaje vuba kandi zifise quality.</p>
            </div>
          </div>
          <div class="card testimonial">
            <div class="avatar" aria-hidden="true"></div>
            <div>
              <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</div>
              <p><strong>Eric:</strong> Chatbot yanshikiye mu ijwi, yanshikiriza amafoto, vyaratumye mpitamwo vuba. üõçÔ∏è</p>
            </div>
          </div>
          <div class="card testimonial">
            <div class="avatar" aria-hidden="true"></div>
            <div>
              <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
              <p><strong>Tr√©sor:</strong> Ibiciro vyabo ni vyiza, plus WhatsApp support irakora neza! üëç</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===========================
         Daily Joke Spinner
         - Joke nshasha buri munsi mu Kirundi
         - localStorage
         - Button yo gusoma mu ijwi
    ============================ -->
    <section id="jokes" class="section reveal" aria-label="Jokes z'umunsi mu Kirundi">
      <div class="container">
        <h2>Joke y‚Äôumunsi ü§πüèΩ‚Äç‚ôÇÔ∏è</h2>
        <div class="card joke-box">
          <p class="joke-text" id="jokeText">Utegereza... turiko turatoranya joke y‚Äôumunsi üòÑ</p>
          <div>
            <button id="newJoke">üîÅ Hindura Joke</button>
            <button id="speakJoke" class="mode-toggle">üîä Soma mu ijwi</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ===========================
         Chatbot Section
         - Input + voice + send
         - Puter.js style logic (hooks)
         - TTS mu Kinyarwanda? (Response voice = Kiswahili)
         - Image generation
         - Emojis mu bisubizo
         - Ibisubizo bijyanye n‚Äôibicuruzwa
    ============================ -->
    <section id="chatbot" class="section reveal" aria-label="Chatbot y'Ubwenge">
      <div class="container">
        <h2>Vugisha Chatbot yacu ü§ñ</h2>
        <div class="chatbot">
          <div class="chat-window" id="chatWindow" aria-live="polite" aria-label="Ibiganiro na chatbot"></div>
          <div class="chat-controls">
            <label for="chatInput" class="sr-only">Andika ubutumwa</label>
            <input id="chatInput" class="input" type="text" placeholder="Baza ikibazo: 'Hari Sneakers?' cyangwa vuga mu ijwi..." />
            <button id="voiceBtn" class="voice-btn" aria-label="Vuga ikibazo mu ijwi">üéôÔ∏è Vuga</button>
            <button id="sendBtn" class="send-btn" aria-label="Rungika">‚û°Ô∏è Rungika</button>
            <button id="imgBtn" class="img-btn" aria-label="Saba ifoto hashingiwe ku bisobanuro">üñºÔ∏è Ifoto</button>
          </div>
          <p class="muted">Chatbot ivuga mu Kiswahili; andika mu Kinyarwanda/Kirundi, canke uvuge ukoresheje ijwi.</p>
        </div>
      </div>
    </section>

    <!-- ===========================
         Google Maps Embed
         - Gihosha Gisandema (coords)
    ============================ -->
    <section id="maps" class="section reveal" aria-label="Aho boutique iri">
      <div class="container">
        <h2>Aho turi üó∫Ô∏è</h2>
        <div class="card map-embed">
          <!-- Latitude -3.36392¬∞, Longitude 29.378 -->
          <iframe
            title="Gihosha Gisandema Location"
            src="https://www.google.com/maps?q=-3.36392,29.378&z=15&output=embed"
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
          ></iframe>
        </div>
      </div>
    </section>

    <!-- ===========================
         Contact Form + WhatsApp Support
         - FormSubmit.io
         - Prefill subject igihe user akanda CTA
         - wa.me autoresponder
    ============================ -->
    <section id="contact" class="section reveal" aria-label="Form yo kutwandikira na WhatsApp support">
      <div class="container">
        <h2>Tuvugane ‚úâÔ∏è</h2>
        <div class="grid grid-2">
          <div class="card">
            <form id="contactForm" action="https://formsubmit.io/send/ornoirbruce5@gmail.com" method="POST">
              <!-- Prefill subject ivuye kuri CTA -->
              <input type="hidden" name="_subject" id="formSubject" value="Boutique Gihosha ‚Äî Ubutumwa" />
              <input type="hidden" name="_redirect" value="https://example.com/thanks" />
              <div class="form-grid grid-2">
                <div>
                  <label for="name"><strong>Izina:</strong></label>
                  <input id="name" name="name" class="input" type="text" placeholder="Andika izina ryawe" required />
                </div>
                <div>
                  <label for="email"><strong>Email:</strong></label>
                  <input id="email" name="email" class="input" type="email" placeholder="ex: w@example.com" required />
                </div>
              </div>
              <div style="margin-top:10px">
                <label for="message"><strong>Ubutumwa:</strong></label>
                <textarea id="message" name="message" placeholder="Andika ubutumwa bwawe..." required></textarea>
              </div>
              <div style="margin-top:12px">
                <button type="submit">Rungika Ubutumwa</button>
              </div>
            </form>
          </div>

          <div class="card">
            <h3>WhatsApp Support ‚òéÔ∏è</h3>
            <p>
              Duhamagare canke utwandikire kuri WhatsApp. Hari autoresponder igufasha vyihuta.
            </p>
            <div class="socials">
              <a id="waLink" class="mode-toggle" target="_blank" rel="noopener"
                 href="https://wa.me/25771633859?text=Mwaramutse%2C%20ndipfuza%20kumenya%20ibiciro%20vy%27ibicuruzwa.%20Murakoze%20üôè">
                WhatsApp:  +25771633859
              </a>
              <div class="card" style="padding:8px 12px">
                Maintenance Support: Turakurikirana amasaha yose üõ†Ô∏è
              </div>
            </div>
            <p style="margin-top:12px">Dukurikira kuri:</p>
            <div class="socials">
              <a class="mode-toggle" target="_blank" rel="noopener" href="https://instagram.com/">Instagram</a>
              <a class="mode-toggle" target="_blank" rel="noopener" href="https://facebook.com/">Facebook</a>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- ===========================
       Footer
       - Contact info + QR code
  ============================ -->
  <footer aria-label="Footer y'amakuru yo kurangiza">
    <div class="container footer-grid">
      <div>
        <p><strong>Contact info:</strong> üìû +25771633859 | üìß ornoirbruce5@gmail.com | üìç Gihosha Gisandema</p>
        <p>¬© 2025 Boutique Gihosha. Serivisi nziza ku giciro ciza.</p>
      </div>
      <div>
        <h4>Imbuga zacu</h4>
        <div class="socials">
          <a class="mode-toggle" target="_blank" rel="noopener" href="https://wa.me/25771633859?text=Mwaramutse%2C%20ndipfuza%20kumenya%20ibiciro%20vy%27ibicuruzwa.%20Murakoze%20üôè">WhatsApp</a>
          <a class="mode-toggle" target="_blank" rel="noopener" href="https://instagram.com/">Instagram</a>
          <a class="mode-toggle" target="_blank" rel="noopener" href="https://facebook.com/">Facebook</a>
        </div>
      </div>
      <div>
        <h4>QR Code</h4>
        <!-- Shyiramo QR code image ya site yawe -->
        <div class="qr" aria-label="QR code ya site">
          <!-- e.g. <img src="qr.png" alt="QR Code ya Boutique" class="qr"> -->
        </div>
      </div>
    </div>
  </footer>

  <!-- ===========================
       Scripts
       - Dark mode
       - Hero audio
       - Reveal on scroll
       - Stock load + search
       - Jokes + localStorage
       - Chatbot logic (Puter.js style hooks)
       - SpeechRecognition + SpeechSynthesis
       - Image generation placeholder
  ============================ -->
  <script>
    /* -----------------------------------------
       Dark mode toggle + persist
    ------------------------------------------ */
    const root = document.documentElement;
    const modeToggle = document.getElementById('modeToggle');
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'light') root.classList.add('light');

    modeToggle.addEventListener('click', () => {
      root.classList.toggle('light');
      localStorage.setItem('theme', root.classList.contains('light') ? 'light' : 'dark');
    });

    /* -----------------------------------------
       Play French greeting when user interacts
    ------------------------------------------ */
    const frGreeting = document.getElementById('frGreeting');
    const ctaBtn = document.getElementById('cta');
    const formSubject = document.getElementById('formSubject');
    const contactForm = document.getElementById('contactForm');

    function playFrenchGreeting() {
      if (!frGreeting) return;
      // User gesture required on browsers; try-catch
      frGreeting.play().catch(() => {});
    }

    ctaBtn.addEventListener('click', () => {
      // Prefill subject igihe user akanda CTA
      formSubject.value = 'Dushorere kugiciro gito ‚Äî Boutique Gihosha';
      playFrenchGreeting();
      // Scroll to contact
      document.querySelector('#contact').scrollIntoView({ behavior: 'smooth' });
    });

    /* -----------------------------------------
       Reveal animations on scroll
    ------------------------------------------ */
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) entry.target.classList.add('visible');
      });
    }, { threshold: 0.12 });

    document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

    /* -----------------------------------------
       Load stock from embedded JSON + live search
    ------------------------------------------ */
    const stockBody = document.getElementById('stockBody');
    const stockJSONEl = document.getElementById('stockJSON');
    const searchInput = document.getElementById('search');
    const refreshStock = document.getElementById('refreshStock');

    let STOCK = [];
    function loadStock() {
      try {
        const data = JSON.parse(stockJSONEl.textContent);
        STOCK = data.items || [];
        renderStock(STOCK);
      } catch (e) {
        console.error('Stock JSON parse error', e);
      }
    }

    function renderStock(items) {
      stockBody.innerHTML = '';
      items.forEach((item, idx) => {
        const tr = document.createElement('tr');
        tr.style.animation = `fadeUp .5s ease ${idx * 80}ms both`;
        tr.innerHTML = `
          <td><img class="prod-img" src="${item.img}" alt="${item.name}"></td>
          <td><strong>${item.name}</strong><br><span>${item.desc}</span></td>
          <td class="price">${item.price}</td>
        `;
        stockBody.appendChild(tr);
      });
    }

    function filterStock(query) {
      query = query.toLowerCase().trim();
      const filtered = STOCK.filter(item =>
        item.name.toLowerCase().includes(query) ||
        item.desc.toLowerCase().includes(query) ||
        (item.tags || []).some(t => t.toLowerCase().includes(query))
      );
      renderStock(filtered);
    }

    searchInput.addEventListener('input', (e) => filterStock(e.target.value));
    refreshStock.addEventListener('click', loadStock);
    loadStock();

    /* -----------------------------------------
       Daily Joke Spinner (Kirundi) + localStorage
    ------------------------------------------ */
    const jokes = [
      "Umuti w‚Äôindwara y‚Äôisoni ni ukuganisha agasozi, ugasubira ukanuza! üòÑ",
      "Umusaza yarya cane, bamubaza igituma, ati: ‚ÄòNdasanga ibanga ni ukugumya inda ifise akazi.‚Äô ü§≠",
      "Umurwanizi w‚Äôudukoko yagiye kurwanya inzige, yagaruka azanye inyoni! üôÉ",
      "Umwana ati: ‚ÄòMama, kuki uduheba kenshi?‚Äô Mama ati: ‚ÄòKugira ubone ukwezi kwose mu rugendo!‚Äô üåô",
      "Uwagurishije isaha, yibagirwa igihe co kuyisubiza! ‚è∞"
    ];
    const jokeText = document.getElementById('jokeText');
    const newJokeBtn = document.getElementById('newJoke');
    const speakJokeBtn = document.getElementById('speakJoke');

    function pickDailyJoke() {
      const todayKey = new Date().toISOString().slice(0,10);
      const saved = JSON.parse(localStorage.getItem('dailyJoke') || '{}');
      if (saved.date === todayKey && typeof saved.index === 'number') {
        return jokes[saved.index];
      }
      const idx = Math.floor(Math.random() * jokes.length);
      localStorage.setItem('dailyJoke', JSON.stringify({ date: todayKey, index: idx }));
      return jokes[idx];
    }
    function setJoke() { jokeText.textContent = pickDailyJoke(); }
    newJokeBtn.addEventListener('click', () => {
      // Force new joke and update storage date to now
      const idx = Math.floor(Math.random() * jokes.length);
      jokeText.textContent = jokes[idx];
      localStorage.setItem('dailyJoke', JSON.stringify({ date: new Date().toISOString().slice(0,10), index: idx }));
    });
    setJoke();

    /* -----------------------------------------
       SpeechSynthesis (Kiswahili) helper
       - Chatbot ivuga mu Kiswahili
    ------------------------------------------ */
    const synth = window.speechSynthesis;
    function speakSwahili(text) {
      const utter = new SpeechSynthesisUtterance(text);
      // Gerageza guhitamo amajwi ya Kiswahili niba aboneka
      const voices = synth.getVoices();
      const swVoice = voices.find(v => /sw|Swahili/i.test(v.lang)) || voices.find(v => /ki|af|en/i.test(v.lang));
      if (swVoice) utter.voice = swVoice;
      utter.rate = 1.0; utter.pitch = 1.0;
      synth.speak(utter);
    }
    // Reload voices on ready
    window.speechSynthesis.onvoiceschanged = () => {};

    /* -----------------------------------------
       SpeechRecognition (Kinyarwanda/Kirundi)
       - Voice input button
    ------------------------------------------ */
    const voiceBtn = document.getElementById('voiceBtn');
    let recognizing = false;
    let recognition;
    try {
      const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
      if (SR) {
        recognition = new SR();
        recognition.lang = 'rw-RW'; // Kinyarwanda (approx). Kirundi may use 'rn-BI' on some devices.
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;

        recognition.onresult = (e) => {
          const text = e.results[0][0].transcript;
          chatInput.value = text;
          handleUserMessage(text, true);
        };
        recognition.onend = () => { recognizing = false; voiceBtn.textContent = 'üéôÔ∏è Vuga'; };
        recognition.onerror = () => { recognizing = false; voiceBtn.textContent = 'üéôÔ∏è Vuga'; };
      }
    } catch (err) {
      console.log('SpeechRecognition not supported');
    }

    voiceBtn.addEventListener('click', () => {
      if (!recognition) {
        alert('Voice recognition ntirashigikirwa kuri browser yawe.');
        return;
      }
      if (recognizing) {
        recognition.stop(); recognizing = false; voiceBtn.textContent = 'üéôÔ∏è Vuga';
      } else {
        recognition.start(); recognizing = true; voiceBtn.textContent = 'üõë Hagarika';
      }
    });

    /* -----------------------------------------
       Chatbot ‚Äî Puter.js style hooks
       - Smart replies (placeholders for LLMs)
       - Product lookup from STOCK
       - Emojis mu bisubizo
       - TTS mu Kiswahili
       - Image generation placeholder
    ------------------------------------------ */
    const chatWindow = document.getElementById('chatWindow');
    const chatInput = document.getElementById('chatInput');
    const sendBtn = document.getElementById('sendBtn');
    const imgBtn = document.getElementById('imgBtn');

    // Helper: append message
    function addMessage(text, who = 'bot', imageUrl = null) {
      const div = document.createElement('div');
      div.className = `msg ${who}`;
      div.innerHTML = imageUrl
        ? `<div>${text}</div><img src="${imageUrl}" alt="Generated" />`
        : `<div>${text}</div>`;
      chatWindow.appendChild(div);
      chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    // Emoji mapper based on keywords
    function pickEmojis(text) {
      const t = text.toLowerCase();
      const list = [];
      if (t.includes('inkweto') || t.includes('sneakers')) list.push('üëü');
      if (t.includes('t-shirt')) list.push('üëï');
      if (t.includes('cap')) list.push('üß¢');
      if (t.includes('bag') || t.includes('isakoshi')) list.push('üëú');
      if (t.includes('igiciro') || t.includes('price')) list.push('üíµ');
      if (t.includes('murakoze') || t.includes('thank')) list.push('üôè');
      if (list.length === 0) list.push('‚ú®');
      return ' ' + list.join(' ');
    }

    // Product search in STOCK
    function searchProducts(query) {
      query = (query || '').toLowerCase();
      const found = STOCK.filter(item =>
        item.name.toLowerCase().includes(query) ||
        item.desc.toLowerCase().includes(query) ||
        (item.tags || []).some(t => t.toLowerCase().includes(query))
      );
      return found;
    }

    // Placeholder: smart reply generator (simulate Puter.js logic)
    async function smartReply(prompt) {
      // Aha ni ho ushyira API calls (GPT-4o, Claude, Gemini) ‚Äî tubanza dusubize mu Kinyarwanda, chatbot ivuga mu Kiswahili
      const baseReply = `Murakoze kubaza! ${prompt ? 'Twabibonye: ' + prompt + '.' : ''} Dufise serivisi yihuta, ibiciro vyiza, kandi dushobora kukwereka amafoto y‚Äôibicuruzwa.`;
      return baseReply + pickEmojis(prompt || '');
    }

    // Placeholder: image generation using description (puter.ai.txt2img style)
    async function generateImage(description) {
      // Guhuzwa n‚Äôapi yawe: subiza URL y‚Äôifoto yavuye mu AI
      // Ubu dukoresha placeholder y‚Äôimge yo muri repo yawe (shyiramo URL yawe)
      const fallback = 'img/generated_placeholder.jpg';
      return fallback;
    }

    // Handle user message
    async function handleUserMessage(text, fromVoice = false) {
      if (!text || !text.trim()) return;
      addMessage(text, 'user');

      // 1) Reba niba ari ikibazo kijanye n‚Äôibicuruzwa
      const found = searchProducts(text);
      if (found.length > 0) {
        const lines = found.slice(0, 3).map(p => `‚Ä¢ ${p.name} ‚Äî ${p.price}`).join('\n');
        const reply = `Ego, ibicuruzwa biboneka:\n${lines}\nWipfuza ko tubikwereka mu mafoto canke tukubwira igiciro c'inyongera?` + pickEmojis(text);
        addMessage(reply, 'bot');
        speakSwahili('Ndiyo, bidhaa zinapatikana. Tafadhali chagua unachotaka, au uliza bei zaidi.');
        return;
      }

      // 2) Smart reply + emojis
      const reply = await smartReply(text);
      addMessage(reply, 'bot');

      // 3) TTS mu Kiswahili (response voice)
      speakSwahili('Asante kwa swali lako. Tuko tayari kukusaidia kununua kwa bei nzuri.');

      // 4) Niba user asabye ifoto
      if (/foto|ifoto|ishusho|image|picture/i.test(text)) {
        const url = await generateImage(text);
        addMessage('Dore ifoto yegeranye n‚Äôico wasavye üñºÔ∏è', 'bot', url);
        speakSwahili('Hii ndiyo picha inayokaribiana na ulivyoomba.');
      }
    }

    sendBtn.addEventListener('click', () => handleUserMessage(chatInput.value));
    chatInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') handleUserMessage(chatInput.value);
    });

    // Image generation button
    imgBtn.addEventListener('click', async () => {
      const prompt = chatInput.value || 'Ishusho y‚Äôinkweto z‚Äôumukara zigezweho';
      const url = await generateImage(prompt);
      addMessage('Ishusho y‚Äôivyo usavye üñºÔ∏è', 'bot', url);
      speakSwahili('Picha imetolewa kulingana na maelezo yako.');
    });

    /* -----------------------------------------
       Accessibility: focus on CTA
    ------------------------------------------ */
    window.addEventListener('load', () => {
      // Focus CTA for keyboard users
      ctaBtn.focus();
    });

    /* -----------------------------------------
       Audio greeting: also play on first scroll
    ------------------------------------------ */
    let greeted = false;
    function greetOnce() {
      if (greeted) return;
      greeted = true;
      playFrenchGreeting();
    }
    document.addEventListener('scroll', greetOnce);
    document.addEventListener('click', greetOnce);
  </script>
</body>
</html>
```[43dcd9a7-70db-4a1f-b0ae-981daa162054](https://github.com/sa2int/php/tree/9478e531e4d79f3c5a927bc755da12a4e5686477/Desktop%2FPHP%2Fmachine%2Fheader.php?citationMarker=43dcd9a7-70db-4a1f-b0ae-981daa162054 "1")[43dcd9a7-70db-4a1f-b0ae-981daa162054](https://github.com/tatsumizu0430/tatsumizu0430.github.io/tree/36e97ce58a86b8f7b44971ec761912ccc1a32c65/portfolio%2Findex.php?citationMarker=43dcd9a7-70db-4a1f-b0ae-981daa162054 "2")
